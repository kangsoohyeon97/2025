# psychology_test_with_recommendations.py

import streamlit as st

st.set_page_config(page_title="심리 테스트", layout="centered")
st.title("🧠 당신의 심리 유형 테스트")
st.write("10개의 질문에 답하고 당신의 심리적 성향을 알아보세요!")

# 점수 초기화
scores = {
    "분석형": 0,
    "감정형": 0,
    "혼란형": 0,
    "행동형": 0
}

# 질문 목록
questions = [
    {
        "question": "1. 누군가 고민을 이야기하면 나는?",
        "options": {
            "해결 방법을 제시한다.": "분석형",
            "감정에 공감하고 위로한다.": "감정형",
            "괜히 불안해져서 같이 걱정한다.": "혼란형",
            "이야기를 빨리 넘기고 다른 걸 한다.": "행동형"
        }
    },
    {
        "question": "2. 갑작스러운 일정 변경이 생기면?",
        "options": {
            "계획을 다시 정리한다.": "분석형",
            "상대방의 입장을 생각한다.": "감정형",
            "스트레스를 크게 받는다.": "혼란형",
            "그냥 적응한다. 문제없다.": "행동형"
        }
    },
    {
        "question": "3. 낯선 사람들과의 모임에서는?",
        "options": {
            "대화를 관찰하며 분석한다.": "분석형",
            "감정을 나누려 노력한다.": "감정형",
            "긴장되고 불편하다.": "혼란형",
            "즐기며 주도적으로 나선다.": "행동형"
        }
    },
    {
        "question": "4. 스트레스를 받았을 때 나는?",
        "options": {
            "조용히 정리하고 생각한다.": "분석형",
            "누군가에게 털어놓는다.": "감정형",
            "예민해지고 걱정이 많아진다.": "혼란형",
            "운동하거나 뭔가를 해버린다.": "행동형"
        }
    },
    {
        "question": "5. 친구와 갈등이 생기면?",
        "options": {
            "대화로 논리적으로 풀려 한다.": "분석형",
            "상대의 기분을 먼저 생각한다.": "감정형",
            "그 상황이 계속 떠오르며 힘들다.": "혼란형",
            "시간 지나면 괜찮다며 넘긴다.": "행동형"
        }
    },
    {
        "question": "6. 결정을 내려야 할 때 나는?",
        "options": {
            "이유와 근거를 따진다.": "분석형",
            "기분과 감정에 따른다.": "감정형",
            "망설이고 걱정이 앞선다.": "혼란형",
            "그냥 느낌대로 행동한다.": "행동형"
        }
    },
    {
        "question": "7. 타인의 평가에 대해 나는?",
        "options": {
            "객관적으로 분석하려 한다.": "분석형",
            "감정이 상할 수 있다.": "감정형",
            "오래도록 신경 쓰인다.": "혼란형",
            "신경 안 쓰고 넘긴다.": "행동형"
        }
    },
    {
        "question": "8. 새로운 프로젝트가 주어졌을 때 나는?",
        "options": {
            "계획을 세우고 구조를 짠다.": "분석형",
            "의미와 목적을 고민한다.": "감정형",
            "잘할 수 있을지 걱정된다.": "혼란형",
            "일단 시작해본다.": "행동형"
        }
    },
    {
        "question": "9. 슬픔을 느낄 때 나는?",
        "options": {
            "원인을 찾고 정리한다.": "분석형",
            "눈물을 흘리며 감정을 느낀다.": "감정형",
            "쉽게 빠져나오지 못한다.": "혼란형",
            "슬픔을 잊으려 바쁘게 움직인다.": "행동형"
        }
    },
    {
        "question": "10. 여유 시간이 생기면 나는?",
        "options": {
            "무언가를 배우거나 정리한다.": "분석형",
            "가족, 친구와 감정을 나눈다.": "감정형",
            "마음이 불안해서 쉬기 어렵다.": "혼란형",
            "즉흥 여행을 떠난다.": "행동형"
        }
    },
]

answers = []
for q in questions:
    answer = st.radio(q["question"], list(q["options"].keys()), key=q["question"])
    answers.append(answer)

# 결과 확인 버튼
if st.button("🔍 결과 보기"):
    for i, q in enumerate(questions):
        category = q["options"][answers[i]]
        scores[category] += 1

    # 최고 점수 유형 도출
    result = max(scores, key=scores.get)

    st.subheader(f"🧾 당신의 심리 유형: **{result}**")

    # 결과 텍스트 및 추천
    if result == "분석형":
        description = (
            "🎯 **분석형**\n\n- 문제 해결을 위해 논리적 사고를 사용합니다.\n"
            "- 감정보다는 구조와 계획을 중시해요.\n- 냉정하고 신중한 판단을 잘합니다.\n\n"
            "**📚 추천 책:** 『논리의 기술』 by 찰스 필립스\n"
            "**🎬 추천 영화:** 《인셉션 (Inception)》"
        )
    elif result == "감정형":
        description = (
            "💖 **감정형**\n\n- 감정에 민감하고 따뜻한 사람입니다.\n"
            "- 공감 능력이 뛰어나며, 감성적인 콘텐츠를 좋아해요.\n\n"
            "**📚 추천 책:** 『감정 수업』 by 김병후\n"
            "**🎬 추천 영화:** 《이터널 선샤인》"
        )
    elif result == "혼란형":
        description = (
            "🌀 **혼란형**\n\n- 걱정이 많고 감정 기복이 클 수 있어요.\n"
            "- 안정감을 중요시하며, 내면을 자주 돌아봅니다.\n\n"
            "**📚 추천 책:** 『나는 생각이 너무 많아』 by 크리스텔 프티콜랭\n"
            "**🎬 추천 영화:** 《인사이드 아웃》"
        )
    else:  # 행동형
        description = (
            "🔥 **행동형**\n\n- 즉흥적이고 도전적인 성향이에요.\n"
            "- 생각보다는 행동이 먼저이며, 새로운 경험을 추구합니다.\n\n"
            "**📚 추천 책:** 『기억 전달자』 by 로이스 로리\n"
            "**🎬 추천 영화:** 《포레스트 검프》"
        )

    # 결과 표시
    st.markdown(description)

    # 공유 텍스트 생성
    share_text = f"나의 심리 유형은 [{result}]!\n\n{description}"
    st.text_area("📤 결과 공유 (복사해서 사용하세요)", share_text, height=200)

    st.markdown("---")
    st.caption("※ 재미로 보는 심리 테스트입니다. 결과는 참고용입니다.")
