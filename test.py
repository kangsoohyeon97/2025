import streamlit as st

# 페이지 설정
st.set_page_config(page_title="취향 테스트 & 취미 추천", page_icon="🎯", layout="centered")
st.title("🎯 취향 테스트 & 취미 추천")

# 질문과 선택지 (각 선택지는 성향 태그와 연결)
questions = [
    {"q": "쉬는 날 가장 하고 싶은 건?", "options": {"집에서 영화 보기": ["내향","실내"], "친구 만나러 나가기": ["외향"], "여행 가기": ["자유","실외"], "집에서 밀린 일 처리": ["계획","실내"]}},
    {"q": "무엇을 할 때 가장 행복해?", "options": {"혼자 성취할 때": ["내향","계획"], "사람들과 웃고 떠들 때": ["외향"], "즉흥적으로 새로운 걸 시도할 때": ["자유"], "조용히 쉬면서 충전할 때": ["내향","실내"]}},
    {"q": "친구들이 당신을 뭐라고 할까?", "options": {"차분하고 조용하다": ["내향"], "에너지가 넘친다": ["외향"], "계획적이고 꼼꼼하다": ["계획"], "즉흥적이고 자유롭다": ["자유"]}},
    {"q": "여행 스타일은?", "options": {"숙소에만 머물며 휴식": ["내향","실내"], "관광지를 빠르게 돌며 경험": ["외향","실외"], "즉흥적으로 계획 없이 여행": ["자유"], "세부 일정까지 꼼꼼히 계획": ["계획"]}},
    {"q": "친구 모임에서 나는?", "options": {"조용히 참여": ["내향"], "주도적으로 분위기 이끌기": ["외향"], "즉흥적인 활동 제안": ["자유"], "모임 계획 미리 준비": ["계획"]}},
    {"q": "주말에 하는 운동은?", "options": {"집에서 요가": ["내향","실내"], "야외 달리기": ["실외"], "새로운 스포츠 체험": ["자유","실외"], "정해진 루틴 운동": ["계획","실내"]}},
    {"q": "음악 취향은?", "options": {"잔잔하고 차분한 음악": ["내향"], "신나는 댄스곡": ["외향"], "다양한 장르 탐색": ["자유"], "플레이리스트 미리 계획": ["계획"]}},
    {"q": "쇼핑 스타일은?", "options": {"온라인으로 혼자 구매": ["내향","실내"], "친구와 같이 쇼핑": ["외향"], "충동구매 즐김": ["자유"], "리스트 보고 계획적으로 구매": ["계획"]}},
    {"q": "하루 일과 중 가장 중요시 하는 건?", "options": {"혼자만의 시간": ["내향"], "사람과의 소통": ["외향"], "즉흥적 즐거움": ["자유"], "계획된 시간 활용": ["계획"]}},
    {"q": "독서 취향은?", "options": {"조용히 혼자 읽기": ["내향","실내"], "토론하며 읽기": ["외향"], "새로운 장르 시도": ["자유"], "추천 목록 기반 계획적 읽기": ["계획"]}},
    {"q": "음식 선택 기준은?", "options": {"편안한 집밥": ["내향","실내"], "여럿이 같이 즐기기": ["외향"], "새로운 메뉴 도전": ["자유"], "식단 계획 철저": ["계획"]}},
    {"q": "취미 시간은?", "options": {"혼자 조용히 즐기기": ["내향","실내"], "친구와 함께 즐기기": ["외향"], "새로운 취미 탐색": ["자유"], "정해진 루틴으로 즐김": ["계획"]}},
    {"q": "스트레스 해소 방법은?", "options": {"혼자 명상": ["내향","실내"], "사람들과 수다": ["외향"], "즉흥적 여행": ["자유","실외"], "운동 루틴": ["계획","실내"]}},
    {"q": "영화 취향은?", "options": {"조용한 드라마": ["내향","실내"], "액션/코미디": ["외향"], "실험적/독립영화": ["자유"], "정해진 장르 즐김": ["계획"]}},
    {"q": "일 처리 방식은?", "options": {"혼자 꼼꼼히": ["내향","계획"], "팀워크 중시": ["외향"], "즉흥적으로 처리": ["자유"], "체계적 계획대로": ["계획"]}},
    {"q": "주말 외출은?", "options": {"집에서 휴식": ["내향","실내"], "친구 모임": ["외향"], "갑작스러운 여행": ["자유","실외"], "계획된 일정 소화": ["계획"]}},
    {"q": "SNS 활용은?", "options": {"조용히 구경": ["내향"], "자주 소통": ["외향"], "새로운 기능 도전": ["자유"], "계획적으로 포스팅": ["계획"]}},
    {"q": "선물 고를 때 나는?", "options": {"혼자 고민": ["내향","실내"], "친구와 상의": ["외향"], "창의적/즉흥적": ["자유"], "리스트 기반 계획적 선택": ["계획"]}},
    {"q": "휴가 계획은?", "options": {"집에서 휴식": ["내향","실내"], "여럿과 여행": ["외향","실외"], "즉흥 여행": ["자유","실외"], "세부 일정 철저 준비": ["계획"]}},
    {"q": "학습/공부 스타일은?", "options": {"혼자 집중": ["내향","실내"], "그룹 스터디": ["외향"], "새로운 방식 실험": ["자유"], "계획표 따라 학습": ["계획"]}}
]

# 세션 초기화
if "answers" not in st.session_state:
    st.session_state.answers = {}

st.subheader("📝 질문에 답해주세요")

# 질문 출력
for i, q in enumerate(questions):
    st.session_state.answers[i] = st.radio(
        f"{i+1}. {q['q']}",
        list(q["options"].keys()),
        key=f"q_{i}"
    )

# 결과 버튼
if st.button("결과 보기"):
    # 점수 집계
    scores = {"내향":0, "외향":0, "계획":0, "자유":0, "실내":0, "실외":0}
    for i, q in enumerate(questions):
        ans = st.session_state.answers[i]
        traits = q["options"][ans]
        for t in traits:
            scores[t] += 1

    # 대표 성향 도출
    main_traits = [
        "내향" if scores["내향"] >= scores["외향"] else "외향",
        "계획" if scores["계획"] >= scores["자유"] else "자유",
        "실내" if scores["실내"] >= scores["실외"] else "실외"
    ]

    st.subheader("📊 당신의 성향")
    st.write(" 👉 " + " / ".join(main_traits))

    # 취미 추천
    hobby_map = {
        ("내향","계획","실내"): ["독서", "퍼즐 맞추기", "글쓰기"],
        ("내향","자유","실내"): ["그림 그리기", "넷플릭스 감상", "요리"],
        ("외향","계획","실외"): ["등산", "자전거 타기", "단체 스포츠"],
        ("외향","자유","실외"): ["여행", "댄스", "보드게임 모임"],
        ("외향","자유","실내"): ["악기 연주", "보드게임", "쿠킹 클래스"],
        ("내향","계획","실외"): ["사진 찍기", "조깅", "정원 가꾸기"],
        ("내향","자유","실외"): ["캠핑", "자전거 여행", "사진 찍기"],
        ("외향","계획","실내"): ["요가 클래스", "헬스", "그룹 활동"],
    }
    hobby_recommend = hobby_map.get(tuple(main_traits), ["명상", "산책", "요리"])

    st.subheader("🎉 추천 취미")
    for h in hobby_recommend:
        st.write(f"- {h}")
